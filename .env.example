# ========================================
# FPTU Chatbot Configuration
# ========================================

# Gemini API
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-2.0-flash-exp
GEMINI_TEMPERATURE=0.7
GEMINI_MAX_TOKENS=2048

# Embedding Model
EMBEDDING_MODEL=BAAI/bge-m3
EMBEDDING_DIM=1024
EMBEDDING_DEVICE=cpu
EMBEDDING_BATCH_SIZE=32

# Reranker Model
RERANKER_MODEL=BAAI/bge-reranker-base
RERANKER_DEVICE=cpu
RERANKER_BATCH_SIZE=16

# Retrieval Parameters
# ========================================
# IMPORTANT: Adjust these for performance
# ========================================
TOP_K_BM25=20          # Giảm từ 50 → 20 (tăng tốc)
TOP_K_DENSE=20         # Giảm từ 50 → 20 (tăng tốc)
TOP_K_RERANK=30        # Giảm từ 100 → 30 (tăng tốc rerank)
TOP_K_FINAL=5          # Giảm từ 8 → 5 (đủ dùng)

# BM25 weights
BM25_K1=1.5
BM25_B=0.75

# Hybrid fusion
HYBRID_WEIGHT_BM25=0.5
HYBRID_WEIGHT_DENSE=0.5

# FAISS Index
FAISS_INDEX_TYPE=Flat   # Flat (chính xác) hoặc HNSW (nhanh hơn)
FAISS_METRIC=inner_product
FAISS_NPROBE=10
FAISS_M=16
FAISS_EFCONSTRUCTION=200
FAISS_EFSEARCH=50

# Chunking
CHUNK_SIZE=800
CHUNK_OVERLAP=200
MIN_CHUNK_TOKENS=50
USE_SEMANTIC_CHUNKING=true

# PDF Processing
PDF_STRATEGY=hi_res
OCR_LANGUAGES=vie+eng
USE_TABLE_EXTRACTION=true
REMOVE_FOOTER=true
FOOTER_THRESHOLD=70

# Paths
DATA_DIR=./data
INDEX_DIR=./indexes
CACHE_DIR=./.cache
LOG_DIR=./logs

# Server
HOST=0.0.0.0
PORT=8000
WORKERS=1
LOG_LEVEL=info

# Performance
# ========================================
# Để tăng tốc độ response:
# 1. Giảm TOP_K_* xuống 20-30
# 2. Tắt reranking trong frontend (use_rerank: false)
# 3. Giảm GEMINI_MAX_TOKENS xuống 1024
# 4. Tăng batch_size lên 64 nếu RAM đủ
# ========================================
